{% extends "coreui_base_wow.html" %}

{% block title %}Student Details – {{ results.id }}{% endblock %}

{% block content %}
  {% include '_breadcrumbs.html' %}

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">Student Details</h1>
    <a href="{{ url_for('main.enter_report_card') }}" class="btn btn-primary btn-sm">Edit GPA</a>
  </div>

  <!-- Summary -->
  <div class="card mb-4">
    <div class="card-body">
      <dl class="row mb-0">
        <dt class="col-sm-3">Student ID</dt>
        <dd class="col-sm-9">{{ results.id }}</dd>

        <dt class="col-sm-3">Applying Grade</dt>
        <dd class="col-sm-9">{{ results.grade }}</dd>

        <dt class="col-sm-3">Current School</dt>
        <dd class="col-sm-9">{{ results.current_school }}</dd>

        <dt class="col-sm-3">Predicted GPA</dt>
        <dd class="col-sm-9">
          {% if results.pred_gpa is not none %}{{ results.pred_gpa }}{% else %}<span class="text-body-secondary">—</span>{% endif %}
        </dd>
      </dl>
    </div>
  </div>

  <!-- Admissions Scores -->
  <div class="card">
    <div class="card-header">Admissions Scores</div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered align-middle w-auto">
          <thead>
            <tr>
              <th scope="col"></th>
              <th scope="col" colspan="2">Original</th>
              <th scope="col" colspan="2">Retest</th>
            </tr>
            <tr>
              <th scope="col"></th>
              <th scope="col">Raw Input Value</th>
              <th scope="col">Matrix Score</th>
              <th scope="col">Raw Input Value</th>
              <th scope="col">Matrix Score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Admissions Language</th>
              <td>{{ results.language_test_scores }}</td>
              <td>{{ results.matrix_languauge }}</td> {# keep existing key spelling #}
              <td>{{ results.language_test_scores2 }}</td>
              <td>{{ results.matrix_languauge_retest }}</td>
            </tr>
            <tr>
              <th scope="row">Admissions Math</th>
              <td>{{ results.math_test_scores }}</td>
              <td>{{ results.matrix_math }}</td>
              <td>{{ results.math_test_scores2 }}</td>
              <td>{{ results.matrix_math_retest }}</td>
            </tr>
            <tr>
              <th scope="row">Admissions Reading</th>
              <td>{{ results.reading_test_score }}</td>
              <td>{{ results.matrix_reading }}</td>
              <td>{{ results.reading_test_score2 }}</td>
              <td>{{ results.matrix_reading_restest }}</td> {# keep existing key spelling #}
            </tr>
            <tr>
              <th scope="row">
                GPA Points
                <a href="{{ url_for('main.enter_report_card') }}" class="btn btn-link btn-sm p-0 align-baseline">Edit</a>
              </th>
              <td>{{ results.gpa }}</td>
              <td>{{ results.matrix_gpa }}</td>
              <td>{{ results.gpa }}</td>
              <td>{{ results.matrix_gpa }}</td>
            </tr>
            <tr>
              <th scope="row">Total Matrix Points</th>
              <td colspan="2">{{ results.total_points }}</td>
              <td colspan="2">{{ results.total_points_retest }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="mt-3">
        {% for message in messages %}
          <div class="alert alert-success mb-2">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
{% endblock %}
